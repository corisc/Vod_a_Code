<?xml version="1.0" encoding="UTF-8"?>


<project name="99_install" default="controller" basedir="../..">

<typedef resource="net/sf/antcontrib/antlib.xml" />
  
  <target name="controller">
  
  	<property name="verzeichnis_welches_nicht_existieren_darf"     value="./41_platform/microservice_1" />

		<echo message="============================================================================================" />
		<echo message="============================================================================================" />
		<echo message="Build Platform" />
		<echo message="Basisverzeichnis: ${basedir}" />
		<echo message="" />
		<echo message="============================================================================================" />
		<echo message="============================================================================================" />

		<antcall target="target_pruefen_ob_verzeichnis_schon_existiert"/>

  </target>

  <target name="target_platform_installieren">
 		<antcall target="ausgabe">
 			<param name="nachricht"     value="Microservice wird installiert" />
 		</antcall>
 		<copy todir="${verzeichnis_welches_nicht_existieren_darf}/classes" failonerror="true">
	    <fileset dir="./10_eclipse/0_workspace/bwl/classes">
	    	<include name="**/**"/>
	   	</fileset>
	  </copy>
 		<copy todir="${verzeichnis_welches_nicht_existieren_darf}/lib" failonerror="true">
	    <fileset dir="./10_eclipse/0_workspace/bwl/lib">
	    	<include name="**/**"/>
	   	</fileset>
	  </copy>
	  
	  <echo file="${verzeichnis_welches_nicht_existieren_darf}/../01_starte_microservice_1.bat" append="false">
90_java\bin\java.exe -cp microservice_1\classes;microservice_1\lib\commons-codec.jar;microservice_1\commons-httpclient.jar;microservice_1\lib\commons-logging-adapters.jar;microservice_1\lib\commons-logging-api.jar;microservice_1\lib\commons-logging.jar;microservice_1\lib\dsn.jar;microservice_1\lib\hsqldb.jar;microservice_1\lib\imap.jar;microservice_1\lib\jdom.jar;microservice_1\lib\mail.jar;microservice_1\lib\mailapi.jar;microservice_1\lib\mdg.jar;microservice_1\lib\mdg_obf.jar;microservice_1\lib\pop3.jar;microservice_1\lib\smtp.jar bwl._MicroService1
pause
		</echo>

  </target>
		
		
  <target name="target_pruefen_ob_verzeichnis_schon_existiert">
		<if>
			<available file="${verzeichnis_welches_nicht_existieren_darf}" type="dir" />
			
			<then>
				<!-- Ausgabe -->
				<antcall target="ausgabe">
					<param name="nachricht"     value="Bitte den Microservice 1 erst loeschen" />
				</antcall>		
				<fail message="Installation wurde unterbrochen" />       	
			</then>
			<else>
				<antcall target="target_platform_installieren"/>
			</else>
		</if>
  	
  </target>
		
	<target name="ausgabe" >
		<echo message="" />
		<echo message="******************************************************************" />
		<echo message="* ${nachricht}" />		
		<echo message="******************************************************************" />
	</target>



</project>